![knnsim_logo](logo/logo.png "KNNSim")

This repository contains a simulator written in C language to evaluate the performance of the K-Nearest Neighbors clustering algorithm in different platforms, the KNNSim.

1. [Content of this repository](#content-of-this-repository)
2. [Usage](#usage)
3. [How to compile datasets](#how-to-compile-datasets)

## Content of this repository

The content of this repository is as follows:
* `./` contains the source of the simulator. To compile:
  - **Linux:** type `make`;
  - **macOS:** define `MACOS=1` as a bash variable and type `make`.
* `./datasets/` contains the raw data of seven datasets that were download from [UCI Machine Learning Repository](https://archive.ics.uci.edu/ml/index.php) and precompiled binaries that can be used out of the box with KNNSim:
  * [Iris](https://archive.ics.uci.edu/ml/datasets/Iris)
  * [Wine](https://archive.ics.uci.edu/ml/datasets/Wine)
  * [Breast Cancer Wisconsin (Diagnostic)](https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+%28Diagnostic%29)
  * [Car Evaluation](https://archive.ics.uci.edu/ml/datasets/Car+Evaluation)
  * [Abalone](https://archive.ics.uci.edu/ml/datasets/Abalone)
  * [Human Activity Recognition Using Smartphones](https://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones)
  * [Bank Marketing](https://archive.ics.uci.edu/ml/datasets/Bank+Marketing)
  * [Poker Hand](https://archive.ics.uci.edu/ml/datasets/Poker+Hand)
  * Additionally, there is source code on `./datasets/8_dataset_gen` to generate random datasets. This tool is, however, unnecessary since KNNSim generates random datasets natively whenever a binary file is not provided.
* `./sim/` contains some experimental results extracted from several runnings on different systems.

## Usage

To know how to use KNNSim, just type `./knnsim -h` after compiling the software. It will produce:
```
[USAGE]: ./knnsim <#control> <#classify> <#features> <#classes> <#neighbors> [options]

    #control : size of the control universe
   #classify : number of samples to be classified
   #features : number of features per each sample
    #classes : number of different classes in the control universe (smaller than #control)
  #neighbors : (k) number of closest neighbors needed to classify a sample

[options]

           --run-type, -r : specify run-type plain or multithread (default=plain)
  --number-of-threads, -t : specify the number of threads and should be used with -r (default=1)
         --input-file, -f : binary file that includes control samples, classify samples and classes (default=none)
```

When not specifying a binary input file, the used dataset will be randomly generated by KNNSim. Since the K-Nearest Neighbors algorithm is deterministic, the performance of KNN is not affected by the quantitative values of the coordinates from the dataset.

When using a real precompiled dataset, the necessary parameters to run it can be found at `./datasets/<dataset_name>/<dataset_name>.cfg`. For instance, to use the dataset on `./datasets/bin/7_poker_hand.bin`, the parameters can be found in `./datasets/7_poker_hand/poker.cfg`. For example:
```
./knnsim 25010 1000000 10 10 4 --run-type multithread --input-file datasets/bin/7_poker_hand.bin
```

The output can be, for instance:
```
         Hostname: morgana.uconnect.utah.edu
         Run type: 1
Number of threads: 8
 Elapsed time [s]: 66.813626
```

## How to compile datasets

Datasets have to have a fixed format to be used by KNNSim. The file containing the training samples, the test samples and the classes of the training samples has to be binary and is organized as follows:
1. `N * M` floats corresponding to the training samples. Let A be the universe of training samples with `A(i) = a(i, 0), a(i, 1), ..., a(i, M-1)` a training sample and respective coordinates, then it should be organized in the binary dataset file in the format:
```
  a(0, 0),   a(0, 1), ...,   a(0, M-1)
  a(1, 0),   a(1, 1), ...,   a(1, M-1)
     :          :               :
a(N-1, 0), a(N-1, 1), ..., a(N-1, M-1)
```
2. `N' * M` floats corresponding to the test samples. Let B be the universe of test samples with `B(i) = b(i, 0), b(i, 1), ..., b(i, M-1)` a training sample and respective coordinates, then it should be organized in the binary dataset file in the format:
```
   b(0, 0),    b(0, 1), ...,    b(0, M-1)
   b(1, 0),    b(1, 1), ...,    b(1, M-1)
      :           :                :
b(N'-1, 0), b(N'-1, 1), ..., b(N'-1, M-1)
```
3. `N` integers corresponding to the classes of the training samples. Let `C(A(i))` be the class of the training sample `i`, then the classes should be organized in the binary dataset file as follows:
```
C(A(0)), C(A(1)), ..., C(A(N-1))
```
